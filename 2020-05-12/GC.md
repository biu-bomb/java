# 垃圾判断

``java``中，除了基础数值，引用对象的实体都处于堆空间，其他地方通过引用指向对象实体。

## 引用计数

- 原理
  - 如果没有引用，必然垃圾无疑
  - 引用``+1``，解引用``-1``
- 缺陷
  - 无堆外引用，垃圾互引用、自引用

## 可达分析

> 简单引用不做准，需要源头的引用在堆外。

| GCROOTS          | TYPE                                 |
| ---------------- | ------------------------------------ |
| ``JAVA``虚拟机栈 | 栈帧本地变量表引用对象               |
| 方法区           | 类静态属性引用对象<br />常量引用对象 |
| 本地方法栈       | ``JNI``本地方法引用对象              |

# 回收算法

| 算法     | 原理               | 优势                   | 弊端     |
| -------- | ------------------ | ---------------------- | -------- |
| 标记清除 | 标记垃圾，清空垃圾 | 简单、直接             | 空间碎片 |
| 标记复制 | 标记垃圾，对称复制 | 直接复制，空间整齐     | 额外空间 |
| 标记整理 | 标记垃圾，内存重排 | 原地整理，空间利用率高 | 操作繁琐 |

# 分代理论

- 弱分代假说：大多数对象都是朝生夕灭
- 强分代假说：熬过多次垃圾回收的对象越难以消亡
- 跨带引用就说：跨带引用相对于同代引用仅占极少数

